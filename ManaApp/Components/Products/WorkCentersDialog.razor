@using ManaApp.Models
@using Syncfusion.Blazor.Popups
@namespace ManaApp.Components.Products

<SfDialog Width="420px"
          CssClass="workCentersDialog"
          ShowCloseIcon="true"
          IsModal="true"
          ZIndex="10070"
          Header="Darba centri"
          Visible="Visible"
          VisibleChanged="VisibleChanged">

    <DialogTemplates>
        <Content>

            <div class="manage-toolbar">
                <input class="manage-input-small wc-input"
                    type="text"
                    placeholder="Pievienot jaunu darba centru"
                    @bind="NewName" />

                <button type="button"
                        class="wc-add-btn"
                        title="Pievienot jaunu darba centru"
                        @onclick="OnAdd">
                    Pievienot
                </button>
            </div>

            <table class="manage-table">
                <thead>
                    <tr>
                        <th>Nosaukums</th>
                        <th style="width:120px;"></th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var it in Items ?? Enumerable.Empty<WorkCenterManageDto>())
                    {
            <tr class="@(EditId == it.Id ? "wc-row-edit" : "")">
                <td colspan="2">
                    <div class="wc-row">
                            <span class="wc-name">
                                @if (EditId == it.Id)
                                {
                                <input class="manage-input-small"
                                    type="text"
                                    value="@EditName"
                                    @oninput="e => EditNameChanged.InvokeAsync(e.Value?.ToString())" />
                                }
                                else
                                {
                                    @it.WorkCentr_Name
                                }
                            </span>

            <span class="wc-actions">
                @if (EditId == it.Id)
                {
                    <button class="wc-save-btn"
                            @onclick="OnSaveEdit">
                        SaglabƒÅt
                    </button>

                    <button class="wc-cancel-btn"
                            @onclick="OnCancelEdit">
                        Atcelt
                    </button>
                }
                else
                {
                    <button class="wc-icon-edit"
                                title="Labot"
                                @onclick="() => OnBeginEdit.InvokeAsync(it)">
                            ‚úé
                        </button>

                        @if (it.IsActive)
                        {
                            <button class="wc-icon-delete"
                                    title="Dzƒìst"
                                    @onclick="() => OnDelete.InvokeAsync(it.Id)">
                                üóë
                            </button>
                        }
                }
            </span>
        </div>
    </td>
</tr>
                    }
                </tbody>
            </table>

        </Content>
    </DialogTemplates>

</SfDialog>

@code {
    [Parameter] public bool Visible { get; set; }
    [Parameter] public EventCallback<bool> VisibleChanged { get; set; }

    [Parameter] public List<WorkCenterManageDto>? Items { get; set; }
    [Parameter] public string NewName { get; set; } = "";
    
    [Parameter] public int? EditId { get; set; }
    [Parameter] public string EditName { get; set; } = "";
    [Parameter] public EventCallback<string> EditNameChanged { get; set; }
    [Parameter] public EventCallback OnAdd { get; set; }
    [Parameter] public EventCallback OnSaveEdit { get; set; }
    [Parameter] public EventCallback OnCancelEdit { get; set; }

    [Parameter] public EventCallback<WorkCenterManageDto> OnBeginEdit { get; set; }
    [Parameter] public EventCallback<int> OnDelete { get; set; }
}