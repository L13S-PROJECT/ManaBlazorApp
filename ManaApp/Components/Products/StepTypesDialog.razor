@using ManaApp.Models
@using Syncfusion.Blazor.Popups

<SfDialog Width="460px"
          CssClass="stepTypesDialog"
          ShowCloseIcon="true"
          IsModal="true"
          ZIndex="10060"
          Header="Soƒºu tipu vƒÅrdnƒ´ca"
          Visible="Visible"
          VisibleChanged="VisibleChanged">

    <DialogTemplates>
        <Content>

            <div class="manage-toolbar">
                <input class="manage-input-small step-type-input"
                    type="text"
                    placeholder="Pievienot jaunu nosaukumu"
                    @bind="NewName" />

                <button type="button"
                        class="step-type-add-btn"
                        title="Pievienot jaunu darba soƒºa tipu"
                        @onclick="OnAdd">
                    Pievienot
                </button>
            </div>

            <table class="steps-table">
                <thead>
                    <tr>
                        <th>Nosaukums</th>
                        <th style="width:120px;"></th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var t in Items ?? Enumerable.Empty<StepTypeRow>())
                    {
            <tr class="@(EditId == t.Id ? "step-type-row-edit" : "")">
                <td colspan="2">
                    <div class="step-type-row">
            <span class="step-type-name">
                @if (EditId == t.Id)
                {
                    <input class="manage-input-small"
                        type="text"
                        value="@EditName"
                        @oninput="e => EditNameChanged.InvokeAsync(e.Value?.ToString())" />
                }
                else
                {
                    @t.Name
                }
            </span>

            <span class="step-type-actions">
                @if (EditId == t.Id)
                {
                    <button class="edit-save-btn"
                            @onclick="OnSaveEdit">
                        SaglabƒÅt
                    </button>

                    <button class="edit-cancel-btn"
                            @onclick="OnCancelEdit">
                        Atcelt
                    </button>
                }
                else
                {
                        <button class="icon-btn icon-edit-btn"
                                title="Labot"
                                @onclick="() => OnBeginEdit.InvokeAsync(t)">
                            ‚úé
                        </button>

                    @if (t.IsActive)
                    {
                        <button class="icon-delete-btn"
                                title="Dzƒìst"
                                @onclick="() => OnDelete.InvokeAsync(t.Id)">
                            üóë
                        </button>
                    }
                }
            </span>
        </div>
    </td>
</tr>
                    }
                </tbody>
            </table>

        </Content>
    </DialogTemplates>

</SfDialog>

@code {
    [Parameter] public bool Visible { get; set; }
    [Parameter] public EventCallback<bool> VisibleChanged { get; set; }

    [Parameter] public List<StepTypeRow>? Items { get; set; }
    [Parameter] public string NewName { get; set; } = "";
    [Parameter] public int? EditId { get; set; }
    [Parameter] public string EditName { get; set; } = "";
    [Parameter] public EventCallback<string> EditNameChanged { get; set; }

    [Parameter] public EventCallback OnAdd { get; set; }
    [Parameter] public EventCallback OnSaveEdit { get; set; }
    [Parameter] public EventCallback OnCancelEdit { get; set; }

    [Parameter] public EventCallback<StepTypeRow> OnBeginEdit { get; set; }
    [Parameter] public EventCallback<int> OnDelete { get; set; }


}